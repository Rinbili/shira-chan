(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-13812072"],{"333d":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"block",staticStyle:{"margin-top":"10px",position:"absolute",bottom:"0",right:"0"}},[n("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.SizeChange,"current-change":e.CurrentChange}})],1)},i=[],r=(n("a9e3"),{props:{page:{type:Number,default:1},size:{type:Number,default:10},total:{type:Number,default:10}},data:function(){return{currentPage:1,pageSize:10}},watch:{Page:function(){this.currentPage=this.page},Size:function(){this.pageSize=this.size}},mounted:function(){this.currentPage=this.page,this.pageSize=this.size},methods:{SizeChange:function(e){this.pageSize=e,this.currentPage=1,this.$emit("handlePageSizeChange",this.currentPage,this.pageSize)},CurrentChange:function(e){this.currentPage=e,this.$emit("handlePageCurrentChange",this.currentPage,this.pageSize)}}}),o=r,s=n("2877"),l=Object(s["a"])(o,a,i,!1,null,"582eac06",null);t["a"]=l.exports},b848:function(e,t,n){"use strict";n.r(t);var a,i,r,o,s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("div",[n("span",[e._v("报修人联系电话：")]),n("el-input",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{placeholder:"请输入联系电话",size:"small"},model:{value:e.query.selectInput,callback:function(t){e.$set(e.query,"selectInput",t)},expression:"query.selectInput"}}),n("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:e.search}},[e._v("查询")]),n("el-button",{attrs:{icon:"el-icon-refresh-right",size:"small"},on:{click:e.reset}},[e._v("重置")]),n("el-button",{attrs:{type:"success",icon:"el-icon-refresh",size:"small"},on:{click:e.refresh}},[e._v("刷新")])],1),n("div",{staticStyle:{"margin-top":"10px"}},[n("el-button",{attrs:{type:"primary",icon:"el-icon-circle-check",size:"small"}},[e._v("批量结单")])],1)]),n("div",{staticClass:"center-table",staticStyle:{height:"550px",position:"relative"}},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{data:e.formList,border:"","header-cell-style":{background:"#f3f6fd"},"max-height":"500"}},[n("el-table-column",{attrs:{align:"left",type:"selection"}}),n("el-table-column",{attrs:{align:"center",prop:"createdAt",label:"提交时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(new Date(1e3*t.row.hopeAt).toLocaleString())+" ")]}}])}),n("el-table-column",{attrs:{align:"center",prop:"title",label:"标题"}}),n("el-table-column",{attrs:{align:"center",prop:"type",label:"故障类型"},scopedSlots:e._u([{key:"default",fn:function(t){return["0"===t.row.type?n("span",[e._v("启动故障")]):e._e(),"1"===t.row.type?n("span",[e._v("系统故障")]):e._e(),"2"===t.row.type?n("span",[e._v("蓝屏故障")]):e._e(),"3"===t.row.type?n("span",[e._v("黑屏故障")]):e._e(),"4"===t.row.type?n("span",[e._v("死机故障")]):e._e(),"5"===t.row.type?n("span",[e._v("重启故障")]):e._e(),"6"===t.row.type?n("span",[e._v("电脑服务")]):e._e()]}}])}),n("el-table-column",{attrs:{align:"center",prop:"hopeAt",label:"预约时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(new Date(1e3*t.row.hopeAt).toLocaleString())+" ")]}}])}),n("el-table-column",{attrs:{align:"center",prop:"contact",label:"联系电话"}}),n("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"success",icon:"el-icon-view",size:"small"},on:{click:function(n){return e.formDetail(t.row.id)}}},[e._v("详情")]),n("el-button",{attrs:{type:"primary",icon:"el-icon-circle-check",size:"small"},on:{click:function(n){return e.end(t.row.id)}}},[e._v("结单")])]}}])})],1),n("Pagination",{attrs:{total:Number(e.total),page:e.query.page,size:e.query.limit},on:{handlePageSizeChange:e.getCursor,handlePageCurrentChange:e.getCursor}})],1),n("el-dialog",{attrs:{title:"报修单详情",visible:e.formDilog},on:{"update:visible":function(t){e.formDilog=t}}},[n("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"预约时间"}},[n("el-input",{attrs:{disabled:!0},model:{value:new Date(1e3*e.form.hopeAt).toLocaleString(),callback:function(t){e.$set(new Date(1e3*e.form.hopeAt),"toLocaleString()",t)},expression:"new Date(form.hopeAt * 1000).toLocaleString()"}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"工单标题"}},[n("el-input",{attrs:{disabled:!0},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1)],1)],1),n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"故障类型"}},[n("el-input",{attrs:{disabled:!0},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"联系电话"}},[n("el-input",{attrs:{disabled:!0},model:{value:e.form.contact,callback:function(t){e.$set(e.form,"contact",t)},expression:"form.contact"}})],1)],1)],1),n("el-row",[n("el-form-item",{attrs:{label:"故障描述"}},[n("el-input",{attrs:{type:"textarea",rows:5,disabled:!0},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1)],1)],1)],1)],1)],1)},l=[],c=(n("d81d"),n("333d")),u=n("8785"),d=n("5184"),p=n("2866");function f(e){return p["a"].query({url:"query",method:"post",headers:{"Content-Type":"application/json"},fetchPolicy:"no-cache",query:Object(d["a"])(a||(a=Object(u["a"])(["\n      query (\n        $id: ID!\n        $first: Int\n        $after: Cursor\n        $isFinished: Boolean\n        $isClosed: Boolean\n        $contactContains: String\n      ) {\n        orders(\n          first: $first\n          after: $after\n          where: {\n            hasReceiver: true\n            hasReceiverWith: [{ id: $id }]\n            isClosed: $isClosed\n            isFinished: $isFinished\n            contactContains: $contactContains\n          }\n        ) {\n          edges {\n            cursor\n          }\n          pageInfo {\n            startCursor\n            endCursor\n          }\n        }\n      }\n    "]))),variables:{id:e.uid,first:e.limit*(e.page-1),after:e.after,contactContains:e.selectInput,isFinished:e.isFinished,isClosed:e.isClosed}})}function h(e){return p["a"].query({url:"query",method:"post",headers:{"Content-Type":"application/json"},fetchPolicy:"no-cache",query:Object(d["a"])(i||(i=Object(u["a"])(["\n      query (\n        $id: ID!\n        $first: Int\n        $after: Cursor\n        $isFinished: Boolean\n        $isClosed: Boolean\n        $contactContains: String\n      ) {\n        orders(\n          first: $first\n          after: $after\n          where: {\n            hasReceiver: true\n            hasReceiverWith: [{ id: $id }]\n            isClosed: $isClosed\n            isFinished: $isFinished\n            contactContains: $contactContains\n          }\n        ) {\n          edges {\n            node {\n              id\n              title\n              contact\n              type\n              hopeAt\n              createdAt\n            }\n          }\n          totalCount\n        }\n      }\n    "]))),variables:{id:e.uid,first:e.limit,after:e.after,contactContains:e.selectInput,isFinished:e.isFinished,isClosed:e.isClosed}})}function g(e){return p["a"].query({url:"query",method:"post",headers:{"Content-Type":"application/json"},fetchPolicy:"no-cache",query:Object(d["a"])(r||(r=Object(u["a"])(["\n      query ($id: ID) {\n        orders(where: { id: $id }) {\n          edges {\n            node {\n              id\n              title\n              content\n              contact\n              type\n              hopeAt\n              createdAt\n            }\n          }\n          totalCount\n        }\n      }\n    "]))),variables:{id:e}})}function m(e){return p["a"].mutate({url:"query",method:"post",headers:{"Content-Type":"application/json"},mutation:Object(d["a"])(o||(o=Object(u["a"])(["\n      mutation ($id: ID!) {\n        updateOrder(input: { isFinished: true }, id: $id) {\n          isFinished\n        }\n      }\n    "]))),variables:{id:e}})}var y=n("180d"),b=(n("30c4"),{components:{Pagination:c["a"]},data:function(){return{query:{page:1,limit:10,uid:this.$store.state.user.id,after:null,selectInput:"",isFinished:!1,isClosed:!1},total:"",tableLoading:!1,formList:[{title:"123",submission:"2020-01-01 12:00:00",type:"Downtime",appointment:"2020-01-02 12:00:00",phone:"1234567890",state:"Planned",id:1,evaluation:2.7},{title:"123",submission:"2020-01-02 12:00:00",type:"Downtime",appointment:"2020-01-03 12:00:00",phone:"1234567890",state:"Planned",id:1}],formDilog:!1,form:{}}},mounted:function(){this.getList()},methods:{id:y["id"],getCursor:function(e,t){var n=this;this.query.page=e,this.query.limit=t,1!==this.query.page?(this.query.after=null,f(this.query).then((function(e){n.query.after=e.data.orders.pageInfo.endCursor,n.getList()}))):(this.query.after=null,this.getList())},getList:function(){var e=this;this.tableLoading=!0,h(this.query).then((function(t){e.formList=t.data.orders.edges.map((function(e){return{id:e.node.id,createdAt:e.node.createdAt,hopeAt:e.node.hopeAt,title:e.node.title,type:e.node.type,contact:e.node.contact}})),e.total=t.data.orders.totalCount,e.tableLoading=!1})),this.tableLoading=!1},search:function(){this.getList()},reset:function(){this.query.selectInput="",this.getList()},refresh:function(){this.getList()},formDetail:function(e){var t=this;g(e).then((function(e){switch(t.form=e.data.orders.edges[0].node,t.form.type){case"0":t.form.type="启动故障";break;case"1":t.form.type="系统故障";break;case"2":t.form.type="蓝屏故障";break;case"3":t.form.type="黑屏故障";break;case"4":t.form.type="死机故障";break;case"5":t.form.type="重启故障";break;case"6":t.form.type="其他故障";break}})),this.formDilog=!0},end:function(e){var t=this;m(e).then((function(e){!0===e.data.updateOrder.isFinished?(t.$message.success("操作成功"),t.getList()):(t.$message.error("操作失败"),t.getList())})).catch((function(e){t.$message.error("操作失败"),t.getList()}))}}}),v=b,C=n("2877"),$=Object(C["a"])(v,s,l,!1,null,null,null);t["default"]=$.exports}}]);